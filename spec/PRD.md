# 产品需求文档（PRD）
## 通用设备入库/出库管理客户端  
基于 AITable API · Windows 优先 · Electron · 响应式 Web UI  
版本：V1  
文档类型：标准产品经理 PRD（含流程图/场景说明）

# 1. 产品介绍

## 1.1 产品背景
小团队或小型仓库常用 Excel / 纸张记录设备进出库，效率低且容易出错。本产品提供一个 **基于扫码枪 + AITable 表结构的通用客户端**，帮助仓库管理员快速进行设备入库、出库与盘点。

无需复杂配置，支持自动读取 AITable 的字段结构，适配任何表格格式。

# 2. 产品目标

- ✅ 通过扫码快速完成入库、出库、盘点  
- ✅ 无需账号系统，使用者仅需填写工号 + AITable API Key  
- ✅ 自动读取 AITable 表结构，客户端动态生成字段表单  
- ✅ 支持扫码多个设备一次性出库  
- ✅ 基础离线能力：本地缓存设备列表  
- ✅ Windows 优先，采用 Electron 客户端，全屏扫码模式  

# 3. 使用角色

| 角色 | 权限 |
|------|------|
| 仓库管理员 | 可进行入库、出库、盘点；可设置 API Key；可开启全屏模式 |

无账号系统，仅启动时填写：  
- 工号  
- AITable API Key  
- 数据表 ID / 视图 ID（外部配置）

# 4. 功能范围（Scope）

## ✅ 4.1 动态表结构加载
- 客户端启动后，通过 API 获取：
  - 表字段结构
  - 指定视图内的设备列表
- 客户端根据字段动态构建 UI
- 字段类型自动识别（文本、数字、选择、日期、附件等）

## ✅ 4.2 扫码识别与设备查找
- 扫码枪输入即触发查询  
- 查询逻辑：在本地缓存列表中匹配设备编号  
- 若不存在 → 弹窗提示 **“找不到该设备”**

## ✅ 4.3 入库流程（单设备）
限制：仅可入库“已存在的设备”

流程：
1. 扫码识别设备编号  
2. 若存在 → 显示详情  
3. 显示操作按钮【入库】  
4. 点击入库 → 写入字段：
   - 状态字段（例如：在库）
   - 入库时间（当前时间）
   - 操作人工号

操作后本地缓存自动更新。

## ✅ 4.4 出库流程（支持多设备一次性提交）
出库支持批量操作：

流程：
1. 启动出库模式  
2. 多次扫码 → 将设备加入“出库篮”  
3. 管理员手动输入借用人姓名  
4. 点击【确认出库】 → 一次性提交所有设备更新  
5. 记录字段：
   - 状态=出库  
   - 借用人姓名  
   - 出库时间  
   - 操作人工号  

如果扫码到状态=出库的设备 → 显示提示并不加入以免重复错误。

## ✅ 4.5 盘点模式（轻量版本）
逻辑非常简单：

流程：
1. 点击进入盘点模式  
2. 每次扫码 → 将设备标记为“今日已盘点”  
3. 本地缓存记录盘点标记  
4. 结束盘点后可导出“未盘点设备列表”（本地显示即可，不同步）

同步规则：
- 仅在 AITable 中写入一个字段（例如：`last_checked_at`）  
- 扫码成功即更新该字段

## ✅ 4.6 离线能力（Lite）
离线功能包括：

- 本地缓存设备列表（SQLite / IndexedDB）
- 全部查询操作在本地完成
- 若设备状态更新失败（网络异常）→ 保存在本地“待同步队列”
- 网络恢复时自动同步

## ✅ 4.7 全屏扫码模式
- 启动后进入全屏页面  
- 输入框自动聚焦  
- 扫码枪输入无需点击  
- 大字号提示（成功/失败）  
- 适合仓库固定扫码台使用

## ✅ 4.8 设置页面
包含以下字段：
- 仓库管理员工号  
- AITable API Key  
- Base ID / Table ID  
- 设备视图 ID  
- 是否开启全屏模式  
- 是否启用离线缓存  
- 本地缓存清理按钮

# 5. 非功能性需求

| 项目 | 要求 |
|------|------|
| 系统平台 | Windows（优先），可兼容 macOS |
| 客户端技术 | Electron + React 或 Vue |
| UI | 响应式 Web，适配不同尺寸 |
| 扫码延时 | 单次扫码识别 < 200ms |
| 网络异常处理 | 保证离线可用，后台重试 |
| 典型设备数量 | < 50,000 条（本地缓存可承受） |

# 6. 数据结构（示例）

注意：字段动态读取，无固定格式。  
示例设备字段结构：

| 字段名 | 类型 | 用途 |
|-------|------|------|
| device_id | 文本 | 设备唯一编号（二维码内容） |
| name | 文本 | 名称 |
| type | 单选 | 设备类型 |
| status | 单选 | 在库 / 出库 / 维修 |
| borrower | 文本 | 借用人 |
| location | 文本 | 所在仓库 |
| updated_at | 日期 | 最近更新时间 |
| last_checked_at | 日期 | 最近盘点时间 |

客户端根据 API 自动构建表单，不做字段限制。

# 7. 用户流程（Flow）

## 7.1 入库流程图

扫码 → 查询本地缓存 →
→ 存在？ → 显示详情 → 点击入库 → 调用 API 更新 → 成功
→ 不存在？ → 提示“找不到设备”

## 7.2 出库流程图（批量）

进入出库模式
→ 扫码 n 次 → 加入出库列表
→ 输入借用人姓名
→ 一次性提交出库更新（API 批量）
→ 成功 → 清空出库列表

## 7.3 盘点流程

开启盘点 → 扫码设备
→ 本地记录“已盘点”
→ 写入 last_checked_at 字段
→ 继续扫码
→ 结束盘点 → 显示未盘点设备

# 8. 页面设计（结构大纲）

本客户端采用 **左右结构布局**：

- **左侧 Sidebar（导航 + 用户信息）**
- **右侧 Main Content（根据功能模块切换）**

整体风格偏向简洁、响应式布局，并适配 Windows 全屏扫码场景。

# 8.1 左侧 Sidebar（导航栏）

### ✅ 8.1.1 Sidebar 功能结构

左侧固定宽度（建议 220–260px），包含：

### **导航菜单（从上到下）**
1. **入库（Inbound）**
2. **出库（Outbound）**
3. **盘点（Inventory Check）**
4. **设置（Settings）**

每项使用图标 + 文字，点击后右侧内容区域切换页面。

### ✅ 8.1.2 Sidebar Footer（用户身份卡片）

Sidebar 底部固定一个用户卡片区域，显示：

- 管理员工号  
- 当前绑定的 AITable 信息（如 Base ID 简短展示）
- 【退出登录】按钮

#### 用户卡片 UI 示例（结构）

```
| Sidebar |
| [入库] |
| [出库] |
| [盘点] |
| [设置] |
[ [用户卡片] ]
```

退出登录后回到首次启动的“API 配置页面”。

# 8.2 右侧 Main Content（主内容区域）

根据所选导航项动态渲染不同页面：

## ✅ 8.2.1 入库页面（Inbound）

- 顶部区域：当前模式标题 + 当前时间  
- 中间大区域：扫码框（自动聚焦）  
- 扫码后展示设备详情（动态字段，为只读）  
- 底部操作按钮：  
  - 【确认入库】

若设备不存在 → 弹出红色警告框：“找不到该设备”。

## ✅ 8.2.2 出库页面（Outbound）

包含两个主要区域：

### **左：扫码区**
- 扫码识别窗口（自动聚焦）
- 扫码结果提示（成功/重复/不存在）

### **右：出库篮（Batch List）**
- 已添加设备列表（动态字段简要展示）
- 可删除单项
- 借用人姓名输入框
- 最底部有【提交出库】按钮

结构：
```
右侧内容区：
| [扫码区] | [出库篮列表区] |
| | Borrower 输入框 |
| | [提交出库按钮] |
```

## ✅ 8.2.3 盘点页面（Inventory Check）

- 全屏扫码输入  
- 扫码成功后展示设备信息（绿色提示）  
- 自动更新 last_checked_at 字段  
- 页面包含：
  - 今日已盘点数量
  - 扫码记录列表（前 20 条）

右上角可点击【结束盘点】，并显示未盘点设备统计。

## ✅ 8.2.4 设置页面（Settings）

包含字段：

- 工号输入
- AITable API Key
- Base ID / Table ID / View ID
- 开关项：
  - 启用全屏扫码模式
  - 启用离线缓存
- 操作按钮：
  - 清除本地缓存
  - 查看同步队列状态（若有未同步项）

# 8.3 全屏扫码模式（任意页面可触发）
设置中开启后：

- Sidebar 自动隐藏  
- 主内容区放大为 100%  
- 扫码框自动聚焦  
- 操作按钮缩到右下角小浮窗（或隐藏）

适用于固定仓库扫码台。

# 8.4 适配与交互原则

- 所有表字段 UI 均动态生成（由 AITable 表结构决定）
- 成功/失败提示需足够醒目（绿色/红色）
- 提示信息需支持扫码快速模式（自动消失）
- 响应式设计适配：
  - 1920x1080（标准仓库显示器）
  - Laptop 1366 宽度
  - 小屏幕窗口缩小时自动切换为上下结构

# 8.5 动态字段展示规则

设备详情页字段结构：

- 字段顺序保持与 AITable 一致  
- 文本字段 → 文本展示  
- 单选字段 → 显示选项标签  
- 日期字段 → 格式化为 YYYY-MM-DD HH:mm  
- 附件字段 → 默认不展示图片，仅显示附件名称 + 可跳转按钮